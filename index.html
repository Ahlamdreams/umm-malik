<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª - Ù…Ø¹ Ø§Ù„Ù†Ø¬ÙˆÙ… ÙˆØ§Ù„ØªØ­Ù‚Ù‚</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800&family=Amiri:wght@400;700&display=swap');
        
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --warning-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --danger-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
            position: relative;
            min-height: 100vh;
            overflow-x: hidden;
            animation: gradientShift 20s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0%, 100% { 
                background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
            }
            25% { 
                background: linear-gradient(135deg, #4facfe 0%, #00f2fe 25%, #667eea 50%, #764ba2 75%, #f093fb 100%);
            }
            50% { 
                background: linear-gradient(135deg, #f093fb 0%, #f5576c 25%, #4facfe 50%, #00f2fe 75%, #667eea 100%);
            }
            75% { 
                background: linear-gradient(135deg, #764ba2 0%, #f093fb 25%, #f5576c 50%, #4facfe 75%, #00f2fe 100%);
            }
        }

        .glass-morphism {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        .teacher-card {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .teacher-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .present-card {
            background: var(--success-gradient);
            color: white;
            animation: presentPulse 3s infinite;
            box-shadow: 0 0 30px rgba(79, 172, 254, 0.6);
        }

        @keyframes presentPulse {
            0%, 100% { 
                box-shadow: 0 0 30px rgba(79, 172, 254, 0.6), 0 0 0 0 rgba(79, 172, 254, 0.4); 
            }
            50% { 
                box-shadow: 0 0 40px rgba(79, 172, 254, 0.8), 0 0 0 15px rgba(79, 172, 254, 0); 
            }
        }

        .absent-card {
            background: var(--danger-gradient);
            color: white;
            animation: absentPulse 3s infinite;
        }

        @keyframes absentPulse {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(250, 112, 154, 0.5); 
            }
            50% { 
                box-shadow: 0 0 30px rgba(250, 112, 154, 0.8); 
            }
        }
        
        .fade-in {
            animation: fadeInUp 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(30px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        .success-message {
            animation: slideInBounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            background: var(--success-gradient);
            backdrop-filter: blur(20px);
        }
        
        @keyframes slideInBounce {
            0% { 
                transform: translateX(100%) scale(0.8); 
                opacity: 0;
            }
            60% { 
                transform: translateX(-10%) scale(1.05); 
                opacity: 1;
            }
            100% { 
                transform: translateX(0) scale(1); 
            }
        }

        .star-animation {
            animation: starDance 3s infinite;
            filter: drop-shadow(0 0 10px gold);
        }

        @keyframes starDance {
            0%, 100% { 
                transform: scale(1) rotate(0deg); 
                filter: drop-shadow(0 0 10px gold) hue-rotate(0deg);
            }
            25% { 
                transform: scale(1.2) rotate(90deg); 
                filter: drop-shadow(0 0 15px gold) hue-rotate(90deg);
            }
            50% { 
                transform: scale(1.1) rotate(180deg); 
                filter: drop-shadow(0 0 20px gold) hue-rotate(180deg);
            }
            75% { 
                transform: scale(1.3) rotate(270deg); 
                filter: drop-shadow(0 0 15px gold) hue-rotate(270deg);
            }
        }

        .verification-badge {
            animation: verifyBounce 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            filter: drop-shadow(0 0 8px rgba(34, 197, 94, 0.8));
        }

        @keyframes verifyBounce {
            0% { 
                transform: scale(0) rotate(-180deg); 
                opacity: 0;
            }
            60% { 
                transform: scale(1.3) rotate(10deg); 
                opacity: 1;
            }
            100% { 
                transform: scale(1) rotate(0deg); 
            }
        }

        .stat-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .btn-gradient {
            background: var(--primary-gradient);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-gradient:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
        }

        .tab-button {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            background: var(--primary-gradient);
            color: white;
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #ffd700, #ffed4e, #ffd700);
            animation: tabGlow 2s infinite;
        }

        @keyframes tabGlow {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        .floating-icon {
            animation: floatIcon 3s ease-in-out infinite;
        }

        @keyframes floatIcon {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .pulse-ring {
            animation: pulseRing 2s infinite;
        }

        @keyframes pulseRing {
            0% {
                transform: scale(0.8);
                opacity: 1;
            }
            100% {
                transform: scale(2.4);
                opacity: 0;
            }
        }

        .modal-backdrop {
            backdrop-filter: blur(10px);
            background: rgba(0,0,0,0.8);
        }

        .modal-content {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            animation: modalSlideIn 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(-50px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .class-card {
            background: linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255,255,255,0.2);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .class-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border-color: rgba(255,215,0,0.5);
        }

        .criteria-badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin: 4px;
            transition: all 0.3s ease;
        }

        .criteria-badge:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .certificate-modal {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            border: 3px solid #FFD700;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.5);
            animation: certificateGlow 2s ease-in-out infinite alternate;
        }

        @keyframes certificateGlow {
            0% { box-shadow: 0 0 50px rgba(255, 215, 0, 0.5); }
            100% { box-shadow: 0 0 80px rgba(255, 215, 0, 0.8); }
        }

        .sparkle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #ffd700;
            border-radius: 50%;
            animation: sparkle 2s infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
        }

        .falling-star {
            position: absolute;
            color: #FFD700;
            font-size: 20px;
            animation: fallingStar 3s linear infinite;
        }

        @keyframes fallingStar {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="container mx-auto px-4 py-8 relative">
        <!-- Header -->
        <div class="text-center mb-12">
            <div class="relative inline-block mb-6">
                <div class="absolute inset-0 pulse-ring w-24 h-24 bg-gradient-to-r from-pink-400 to-purple-500 rounded-full opacity-30"></div>
                <div class="relative inline-flex items-center justify-center w-24 h-24 glass-morphism rounded-full floating-icon">
                    <span class="text-4xl">ğŸ‘©â€ğŸ«</span>
                    <div class="sparkle" style="top: 10%; right: 15%; animation-delay: 0s;"></div>
                    <div class="sparkle" style="top: 70%; left: 20%; animation-delay: 0.5s;"></div>
                    <div class="sparkle" style="bottom: 15%; right: 25%; animation-delay: 1s;"></div>
                </div>
            </div>
            <h1 class="text-4xl font-bold text-white mb-4 font-['Amiri'] drop-shadow-2xl">
                âœ¨ Ø§Ù„Ø·Ù€Ø§Ø¨ÙˆØ± Ø§Ù„Ù…Ù€Ø¯Ø±Ø³ÙŠ â­
            </h1>
            <h2 class="text-2xl font-bold text-yellow-300 mb-4 font-['Amiri'] drop-shadow-lg">
                Ø§Ù†Ø¶Ø¨Ø§Ø· ÙŠØ¹ÙƒØ³ ÙˆØ¹ÙŠÙ‹Ø§ØŒ ÙˆÙ†Ø¸Ø§Ù… ÙŠØµÙ†Ø¹ Ø§Ø³ØªØ¯Ø§Ù…Ø©
            </h2>
            
            <!-- Principal Info -->
            <div class="relative mb-6">
                <div class="glass-morphism rounded-3xl px-8 py-6 inline-block shadow-2xl border-2 border-yellow-400 border-opacity-30">
                    <div class="flex items-center gap-4">
                        <div class="relative">
                            <div class="w-16 h-16 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center shadow-lg">
                                <span class="text-3xl">ğŸ‘‘</span>
                            </div>
                            <div class="absolute -top-2 -right-2 star-animation">
                                <span class="text-2xl">âœ¨</span>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-yellow-300 text-sm font-medium mb-1">ØªØµÙ…ÙŠÙ… ÙˆØ¥Ø´Ø±Ø§Ù</p>
                            <h3 class="text-white text-xl font-bold mb-1">Ø£. Ø£Ø­Ù„Ø§Ù… Ø§Ù„Ø­Ù…Ø¯Ø§Ù†ÙŠØ©</h3>
                            <p class="text-gray-200 text-sm flex items-center gap-2">
                                <span class="text-lg">ğŸ«</span>
                                <span>Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <p class="text-gray-100 text-xl mb-6 font-semibold drop-shadow-lg">Ù†Ø¸Ø§Ù… Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª - Ù…Ø¹ Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ø¬ÙˆÙ… ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø°ÙƒÙŠ</p>
            <div class="glass-morphism rounded-2xl px-8 py-4 inline-block">
                <div class="flex items-center gap-4 text-white font-semibold">
                    <div class="flex items-center gap-2">
                        <span class="text-2xl floating-icon">ğŸ“…</span>
                        <span id="currentDate"></span>
                    </div>
                    <div class="w-px h-6 bg-white opacity-30"></div>
                    <div class="flex items-center gap-2">
                        <span class="text-2xl floating-icon">â°</span>
                        <span id="currentTime"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="glass-morphism rounded-3xl p-3 mb-12 shadow-2xl">
            <div class="flex flex-wrap gap-3">
                <button onclick="showTab('attendance')" id="attendanceTab" class="tab-button active flex-1 min-w-fit px-6 py-4 rounded-2xl font-bold transition-all duration-300 flex items-center justify-center gap-3 text-lg">
                    <span class="text-2xl">âœ…</span>
                    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±
                </button>
                <button onclick="showTab('classes')" id="classesTab" class="tab-button flex-1 min-w-fit glass-morphism text-white px-6 py-4 rounded-2xl font-bold transition-all duration-300 hover:scale-105 flex items-center justify-center gap-3 text-lg">
                    <span class="text-2xl">ğŸ†</span>
                    Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ±
                </button>
                <button onclick="showTab('reports')" id="reportsTab" class="tab-button flex-1 min-w-fit glass-morphism text-white px-6 py-4 rounded-2xl font-bold transition-all duration-300 hover:scale-105 flex items-center justify-center gap-3 text-lg">
                    <span class="text-2xl">ğŸ“Š</span>
                    Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
                </button>
                <button onclick="showTab('management')" id="managementTab" class="tab-button flex-1 min-w-fit glass-morphism text-white px-6 py-4 rounded-2xl font-bold transition-all duration-300 hover:scale-105 flex items-center justify-center gap-3 text-lg">
                    <span class="text-2xl">âš™ï¸</span>
                    Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
                </button>
            </div>
        </div>

        <!-- Attendance Tab -->
        <div id="attendanceContent" class="tab-content">
            <!-- Quick Stats -->
            <div class="grid grid-cols-1 md:grid-cols-5 gap-6 mb-12">
                <div class="stat-card rounded-3xl shadow-2xl p-8 text-center transform hover:scale-105 transition-all duration-300">
                    <div class="relative w-16 h-16 mx-auto mb-4">
                        <div class="absolute inset-0 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full opacity-20 pulse-ring"></div>
                        <div class="relative w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center floating-icon">
                            <span class="text-3xl">ğŸ‘¥</span>
                        </div>
                    </div>
                    <h3 class="text-3xl font-bold text-white mb-2 drop-shadow-lg" id="totalTeachers">0</h3>
                    <p class="text-gray-100 font-semibold">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</p>
                </div>
                <div class="stat-card rounded-3xl shadow-2xl p-8 text-center transform hover:scale-105 transition-all duration-300">
                    <div class="relative w-16 h-16 mx-auto mb-4">
                        <div class="absolute inset-0 bg-gradient-to-r from-green-400 to-blue-400 rounded-full opacity-20 pulse-ring"></div>
                        <div class="relative w-16 h-16 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center floating-icon">
                            <span class="text-3xl">âœ…</span>
                        </div>
                    </div>
                    <h3 class="text-3xl font-bold text-green-400 mb-2" id="presentCount">0</h3>
                    <p class="text-white font-semibold">Ø§Ù„Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…</p>
                </div>
                <div class="stat-card rounded-3xl shadow-2xl p-8 text-center transform hover:scale-105 transition-all duration-300">
                    <div class="relative w-16 h-16 mx-auto mb-4">
                        <div class="absolute inset-0 bg-gradient-to-r from-red-400 to-pink-400 rounded-full opacity-20 pulse-ring"></div>
                        <div class="relative w-16 h-16 bg-gradient-to-r from-red-500 to-pink-500 rounded-full flex items-center justify-center floating-icon">
                            <span class="text-3xl">âŒ</span>
                        </div>
                    </div>
                    <h3 class="text-3xl font-bold text-red-400 mb-2" id="absentCount">0</h3>
                    <p class="text-white font-semibold">Ø§Ù„ØºØ§Ø¦Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…</p>
                </div>
                <div class="stat-card rounded-3xl shadow-2xl p-8 text-center transform hover:scale-105 transition-all duration-300">
                    <div class="relative w-16 h-16 mx-auto mb-4">
                        <div class="absolute inset-0 bg-gradient-to-r from-yellow-400 to-orange-400 rounded-full opacity-20 pulse-ring"></div>
                        <div class="relative w-16 h-16 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full flex items-center justify-center floating-icon">
                            <span class="text-3xl star-animation">â­</span>
                        </div>
                    </div>
                    <h3 class="text-3xl font-bold text-yellow-400 mb-2" id="dailyStars">0</h3>
                    <p class="text-white font-semibold">Ù†Ø¬ÙˆÙ… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„ÙŠÙˆÙ…</p>
                </div>
                <div class="stat-card rounded-3xl shadow-2xl p-8 text-center transform hover:scale-105 transition-all duration-300">
                    <div class="relative w-16 h-16 mx-auto mb-4">
                        <div class="absolute inset-0 bg-gradient-to-r from-blue-400 to-indigo-400 rounded-full opacity-20 pulse-ring"></div>
                        <div class="relative w-16 h-16 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-full flex items-center justify-center floating-icon">
                            <span class="text-3xl">ğŸ“Š</span>
                        </div>
                    </div>
                    <h3 class="text-3xl font-bold text-blue-400 mb-2" id="attendanceRate">0%</h3>
                    <p class="text-white font-semibold">Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ±</p>
                </div>
            </div>

            <!-- Teachers Grid -->
            <div class="mb-12">
                <div class="glass-morphism rounded-3xl p-8 mb-8 shadow-2xl">
                    <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                        <h2 class="text-3xl font-bold text-white flex items-center">
                            <span class="text-4xl ml-4 floating-icon">ğŸ‘©â€ğŸ«</span>
                            <span class="text-white drop-shadow-lg">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</span>
                        </h2>
                        <div class="flex gap-4">
                            <button onclick="markAllPresent()" class="btn-gradient text-white px-6 py-3 rounded-2xl font-bold transition-all duration-300 flex items-center gap-3 hover:scale-105 shadow-lg">
                                <span class="text-xl">âœ…</span>
                                ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„ Ø­Ø§Ø¶Ø±
                            </button>
                            <button onclick="clearAttendance()" class="glass-morphism text-white px-6 py-3 rounded-2xl font-bold transition-all duration-300 hover:scale-105 flex items-center gap-3 shadow-lg">
                                <span class="text-xl">ğŸ”„</span>
                                Ù…Ø³Ø­ Ø§Ù„Ø­Ø¶ÙˆØ±
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="teachersGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <div class="col-span-full text-center text-gray-400 py-12">
                        <div class="text-6xl mb-4">ğŸ‘©â€ğŸ«</div>
                        <p class="text-xl font-semibold">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ù„Ù…Ø§Øª Ù…Ø³Ø¬Ù„Ø§Øª Ø¨Ø¹Ø¯</p>
                        <p class="text-sm mt-2">Ø§Ù†ØªÙ‚Ù„ÙŠ Ø¥Ù„Ù‰ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Classes Tab (Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ±) -->
        <div id="classesContent" class="tab-content hidden">
            <!-- Class Competition Header -->
            <div class="glass-morphism rounded-3xl p-8 mb-8 shadow-2xl text-center">
                <h2 class="text-4xl font-bold text-white mb-4 flex items-center justify-center">
                    <span class="text-5xl ml-4 star-animation">ğŸ†</span>
                    <span class="text-white drop-shadow-lg">Ù…Ø³Ø§Ø¨Ù‚Ø© Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ</span>
                </h2>
                <p class="text-gray-100 text-xl font-semibold">ØªÙ†Ø§ÙØ³ Ø¨ÙŠÙ† Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ø®Ø§Ù…Ø³ ÙˆØ§Ù„Ø³Ø§Ø¯Ø³ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ø·Ø§Ø¨ÙˆØ± Ù…Ø¯Ø±Ø³ÙŠ</p>
            </div>

            <!-- Criteria Section -->
            <div class="glass-morphism rounded-3xl p-8 mb-8 shadow-2xl">
                <h3 class="text-2xl font-bold text-white mb-6 flex items-center">
                    <span class="text-3xl ml-3 floating-icon">ğŸ“‹</span>
                    Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="text-center">
                        <div class="w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center mx-auto mb-4 floating-icon">
                            <span class="text-3xl">âš¡</span>
                        </div>
                        <h4 class="text-xl font-bold text-white mb-2">Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù…</h4>
                        <p class="text-gray-300 text-sm">Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø·Ø§Ø¨ÙˆØ± ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯ ÙˆØ§Ù„Ø§Ù†ØªØ¸Ø§Ù… Ø§Ù„Ø³Ø±ÙŠØ¹</p>
                        <div class="criteria-badge mt-3">
                            <span>âš¡</span>
                            <span>20 Ù†Ù‚Ø·Ø©</span>
                        </div>
                    </div>
                    <div class="text-center">
                        <div class="w-20 h-20 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4 floating-icon">
                            <span class="text-3xl">ğŸ”Š</span>
                        </div>
                        <h4 class="text-xl font-bold text-white mb-2">Ø§Ù„ØµÙˆØª Ø§Ù„Ø¹Ø§Ù„ÙŠ</h4>
                        <p class="text-gray-300 text-sm">Ù‚ÙˆØ© ÙˆÙˆØ¶ÙˆØ­ Ø§Ù„ØµÙˆØª ÙÙŠ Ø§Ù„Ù†Ø´ÙŠØ¯ ÙˆØ§Ù„ØªØ­ÙŠØ©</p>
                        <div class="criteria-badge mt-3">
                            <span>ğŸ”Š</span>
                            <span>25 Ù†Ù‚Ø·Ø©</span>
                        </div>
                    </div>
                    <div class="text-center">
                        <div class="w-20 h-20 bg-gradient-to-r from-pink-500 to-red-500 rounded-full flex items-center justify-center mx-auto mb-4 floating-icon">
                            <span class="text-3xl">âœ¨</span>
                        </div>
                        <h4 class="text-xl font-bold text-white mb-2">Ø§Ù„Ù†Ø¸Ø§ÙØ© Ø§Ù„Ø´Ø®ØµÙŠØ©</h4>
                        <p class="text-gray-300 text-sm">Ù†Ø¸Ø§ÙØ© Ø§Ù„Ø²ÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ ÙˆØ§Ù„Ù…Ø¸Ù‡Ø± Ø§Ù„Ø¹Ø§Ù…</p>
                        <div class="criteria-badge mt-3">
                            <span>âœ¨</span>
                            <span>25 Ù†Ù‚Ø·Ø©</span>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-6">
                    <div class="inline-block bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-6 py-3 rounded-2xl font-bold">
                        <span class="text-2xl ml-2">ğŸ†</span>
                        Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: 70 Ù†Ù‚Ø·Ø©
                    </div>
                </div>
            </div>

            <!-- Classes Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                <!-- Grade 5 Classes -->
                <div class="glass-morphism rounded-3xl p-6 shadow-2xl">
                    <h3 class="text-2xl font-bold text-white mb-6 text-center flex items-center justify-center">
                        <span class="text-3xl ml-3">ğŸ“š</span>
                        Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³
                    </h3>
                    <div id="grade5Classes" class="space-y-4">
                        <p class="text-gray-400 text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙˆÙ Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯</p>
                    </div>
                    <button onclick="addGrade5Class()" class="w-full mt-4 btn-gradient text-white py-3 px-6 rounded-2xl font-bold transition-all duration-300 hover:scale-105 flex items-center justify-center gap-2">
                        <span class="text-xl">â•</span>
                        Ø¥Ø¶Ø§ÙØ© ØµÙ Ø®Ø§Ù…Ø³
                    </button>
                </div>

                <!-- Grade 6 Classes -->
                <div class="glass-morphism rounded-3xl p-6 shadow-2xl">
                    <h3 class="text-2xl font-bold text-white mb-6 text-center flex items-center justify-center">
                        <span class="text-3xl ml-3">ğŸ“–</span>
                        Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³
                    </h3>
                    <div id="grade6Classes" class="space-y-4">
                        <p class="text-gray-400 text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙˆÙ Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯</p>
                    </div>
                    <button onclick="addGrade6Class()" class="w-full mt-4 btn-gradient text-white py-3 px-6 rounded-2xl font-bold transition-all duration-300 hover:scale-105 flex items-center justify-center gap-2">
                        <span class="text-xl">â•</span>
                        Ø¥Ø¶Ø§ÙØ© ØµÙ Ø³Ø§Ø¯Ø³
                    </button>
                </div>
            </div>

            <!-- Monthly Winners -->
            <div class="glass-morphism rounded-3xl p-8 shadow-2xl">
                <h3 class="text-2xl font-bold text-white mb-6 flex items-center">
                    <span class="text-3xl ml-3 star-animation">ğŸŒŸ</span>
                    Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø´Ù‡Ø±
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="text-center">
                        <h4 class="text-xl font-bold text-yellow-400 mb-4">ğŸ† Ø¨Ø·Ù„ Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³</h4>
                        <div id="grade5Winner" class="glass-morphism rounded-2xl p-6">
                            <p class="text-gray-300">Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø·Ù„ Ø¨Ø¹Ø¯</p>
                        </div>
                        <button onclick="selectGrade5Winner()" class="mt-4 bg-yellow-500 hover:bg-yellow-600 text-white py-2 px-6 rounded-xl font-bold transition-all duration-300">
                            Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø·Ù„
                        </button>
                    </div>
                    <div class="text-center">
                        <h4 class="text-xl font-bold text-yellow-400 mb-4">ğŸ† Ø¨Ø·Ù„ Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³</h4>
                        <div id="grade6Winner" class="glass-morphism rounded-2xl p-6">
                            <p class="text-gray-300">Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø·Ù„ Ø¨Ø¹Ø¯</p>
                        </div>
                        <button onclick="selectGrade6Winner()" class="mt-4 bg-yellow-500 hover:bg-yellow-600 text-white py-2 px-6 rounded-xl font-bold transition-all duration-300">
                            Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø·Ù„
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reportsContent" class="tab-content hidden">
            <!-- Month Selector -->
            <div class="glass-morphism rounded-2xl shadow-lg p-6 mb-8">
                <h2 class="text-2xl font-bold text-white mb-4 flex items-center">
                    <span class="text-3xl ml-3">ğŸ“…</span>
                    Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´Ù‡Ø±
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-white font-semibold mb-2">Ø§Ù„Ø´Ù‡Ø±</label>
                        <select id="monthSelector" onchange="updateMonthlyReport()" class="w-full px-4 py-3 bg-gray-800 text-white border-2 border-gray-600 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <option value="0">ÙŠÙ†Ø§ÙŠØ±</option>
                            <option value="1">ÙØ¨Ø±Ø§ÙŠØ±</option>
                            <option value="2">Ù…Ø§Ø±Ø³</option>
                            <option value="3">Ø£Ø¨Ø±ÙŠÙ„</option>
                            <option value="4">Ù…Ø§ÙŠÙˆ</option>
                            <option value="5">ÙŠÙˆÙ†ÙŠÙˆ</option>
                            <option value="6">ÙŠÙˆÙ„ÙŠÙˆ</option>
                            <option value="7">Ø£ØºØ³Ø·Ø³</option>
                            <option value="8">Ø³Ø¨ØªÙ…Ø¨Ø±</option>
                            <option value="9">Ø£ÙƒØªÙˆØ¨Ø±</option>
                            <option value="10">Ù†ÙˆÙÙ…Ø¨Ø±</option>
                            <option value="11">Ø¯ÙŠØ³Ù…Ø¨Ø±</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-white font-semibold mb-2">Ø§Ù„Ø³Ù†Ø©</label>
                        <select id="yearSelector" onchange="updateMonthlyReport()" class="w-full px-4 py-3 bg-gray-800 text-white border-2 border-gray-600 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        </select>
                    </div>
                </div>
            </div>

            <!-- Monthly Stats -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="glass-morphism rounded-2xl shadow-lg p-6 text-center">
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3">
                        <span class="text-2xl">ğŸ“…</span>
                    </div>
                    <h3 class="text-2xl font-bold text-blue-400" id="workingDays">0</h3>
                    <p class="text-gray-300">Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„</p>
                </div>
                <div class="glass-morphism rounded-2xl shadow-lg p-6 text-center">
                    <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3">
                        <span class="text-2xl">ğŸ“ˆ</span>
                    </div>
                    <h3 class="text-2xl font-bold text-green-400" id="avgAttendance">0%</h3>
                    <p class="text-gray-300">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø­Ø¶ÙˆØ±</p>
                </div>
                <div class="glass-morphism rounded-2xl shadow-lg p-6 text-center">
                    <div class="w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-3">
                        <span class="text-2xl">ğŸŒŸ</span>
                    </div>
                    <h3 class="text-2xl font-bold text-yellow-400" id="monthlyStars">0</h3>
                    <p class="text-gray-300">Ù†Ø¬ÙˆÙ… Ø§Ù„Ø´Ù‡Ø±</p>
                </div>
                <div class="glass-morphism rounded-2xl shadow-lg p-6 text-center">
                    <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3">
                        <span class="text-2xl">ğŸ†</span>
                    </div>
                    <h3 class="text-2xl font-bold text-purple-400" id="bestDay">-</h3>
                    <p class="text-gray-300">Ø£ÙØ¶Ù„ ÙŠÙˆÙ… Ø­Ø¶ÙˆØ±</p>
                </div>
            </div>

            <!-- Individual Teacher Reports -->
            <div class="glass-morphism rounded-2xl shadow-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                    <span class="text-2xl ml-3">ğŸ‘©â€ğŸ«</span>
                    ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠ
                </h3>
                <div id="teacherReports" class="space-y-4">
                    <p class="text-gray-400 text-center py-8">Ø§Ø®ØªØ§Ø±ÙŠ Ø´Ù‡Ø±Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</p>
                </div>
            </div>

            <!-- Export Monthly Reports -->
            <div class="glass-morphism rounded-2xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                    <span class="text-2xl ml-3">ğŸ“Š</span>
                    ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <button onclick="exportMonthlyReport()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-xl transition duration-200 flex items-center justify-center gap-2">
                        <span>ğŸ“„</span>
                        ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ
                    </button>
                    <button onclick="exportTeacherAttendance()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-xl transition duration-200 flex items-center justify-center gap-2">
                        <span>ğŸ‘©â€ğŸ«</span>
                        ØªØµØ¯ÙŠØ± Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª
                    </button>
                </div>
            </div>
        </div>

        <!-- Management Tab -->
        <div id="managementContent" class="tab-content hidden">
            <!-- System Management Section -->
            <div class="bg-gradient-to-r from-indigo-500 to-purple-600 rounded-2xl shadow-lg p-6 mb-8 text-white">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <span class="text-3xl ml-3">âš™ï¸</span>
                    Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-white bg-opacity-20 rounded-xl p-4">
                        <h3 class="text-lg font-semibold mb-3 flex items-center">
                            <span class="text-2xl ml-2">ğŸ“Š</span>
                            Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª
                        </h3>
                        <div class="space-y-3">
                            <div class="relative">
                                <input type="file" id="excelFile" accept=".xlsx,.xls,.csv" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10" onchange="handleFileUpload(event)">
                                <div class="w-full px-4 py-3 bg-white bg-opacity-20 rounded-xl text-white border-2 border-dashed border-white border-opacity-30 hover:border-opacity-50 transition-all duration-300 cursor-pointer flex items-center justify-center gap-3 min-h-[50px]">
                                    <span class="text-xl">ğŸ“Š</span>
                                    <span class="font-semibold">Ø§Ø¶ØºØ·ÙŠ Ù‡Ù†Ø§ Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</span>
                                </div>
                            </div>
                            <div id="fileStatus" class="text-sm text-white text-opacity-90 hidden">
                                <div class="flex items-center gap-2">
                                    <span class="animate-spin">â³</span>
                                    <span>Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù...</span>
                                </div>
                            </div>
                        </div>
                        <p class="text-sm mt-2 text-white text-opacity-80">
                            ğŸ“‹ ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰: <strong>Ø§Ù„ØµÙ</strong> Ùˆ <strong>Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</strong>
                        </p>
                    </div>
                    <div class="bg-white bg-opacity-20 rounded-xl p-4">
                        <h3 class="text-lg font-semibold mb-3 flex items-center">
                            <span class="text-2xl ml-2">ğŸ‘©â€ğŸ«</span>
                            Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹
                        </h3>
                        <button onclick="showAddTeacherForm()" class="w-full bg-white text-purple-600 font-bold py-3 px-6 rounded-xl hover:bg-gray-100 transition duration-200 flex items-center justify-center gap-2">
                            <span>â•</span>
                            Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©
                        </button>
                        <p class="text-sm mt-2 text-white text-opacity-80">
                            Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…Ø© ÙˆØ§Ø­Ø¯Ø© Ø¨Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù…Ø§Ø¯Ø© ÙˆØ§Ù„Ù…ÙˆÙ‚Ø¹
                        </p>
                    </div>
                </div>
            </div>

            <!-- Data Management -->
            <div class="glass-morphism rounded-2xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                    <span class="text-2xl ml-3">ğŸ’¾</span>
                    Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button onclick="exportAllData()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-xl transition duration-200 flex items-center justify-center gap-2">
                        <span>ğŸ’¾</span>
                        Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ
                    </button>
                    <button onclick="importData()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-xl transition duration-200 flex items-center justify-center gap-2">
                        <span>ğŸ“¥</span>
                        Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    </button>
                    <button onclick="clearAllData()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-xl transition duration-200 flex items-center justify-center gap-2">
                        <span>ğŸ—‘ï¸</span>
                        Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    </button>
                </div>
            </div>
        </div>

        <!-- Add Teacher Form Modal -->
        <div id="addTeacherModal" class="fixed inset-0 modal-backdrop hidden flex items-center justify-center z-50">
            <div class="modal-content rounded-3xl p-10 max-w-lg w-full mx-4 shadow-2xl">
                <h3 class="text-3xl font-bold text-white mb-8 flex items-center justify-center drop-shadow-2xl">
                    <span class="text-4xl ml-4 floating-icon">ğŸ‘©â€ğŸ«</span>
                    <span class="text-white">Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©</span>
                </h3>
                <form id="addTeacherForm" onsubmit="addTeacher(event)">
                    <div class="space-y-6">
                        <div>
                            <label class="block text-white font-bold mb-3 text-lg">Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</label>
                            <input type="text" id="teacherName" required class="w-full px-6 py-4 glass-morphism rounded-2xl text-white placeholder-white placeholder-opacity-70 focus:ring-2 focus:ring-white focus:ring-opacity-50 transition-all duration-300 text-lg" placeholder="Ø£Ø¯Ø®Ù„ÙŠ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…Ø©...">
                        </div>
                        <div>
                            <label class="block text-white font-bold mb-3 text-lg">Ø§Ù„Ù…Ø§Ø¯Ø©</label>
                            <select id="teacherSubject" required class="w-full px-6 py-4 glass-morphism rounded-2xl text-white focus:ring-2 focus:ring-white focus:ring-opacity-50 transition-all duration-300 text-lg">
                                <option value="" class="bg-gray-800">Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ù…Ø§Ø¯Ø©...</option>
                                <option value="Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª" class="bg-gray-800">ğŸ”¢ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª</option>
                                <option value="Ø§Ù„Ø¹Ù„ÙˆÙ…" class="bg-gray-800">ğŸ”¬ Ø§Ù„Ø¹Ù„ÙˆÙ…</option>
                                <option value="Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©" class="bg-gray-800">ğŸ“– Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                                <option value="Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©" class="bg-gray-800">ğŸ‡¬ğŸ‡§ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option>
                                <option value="Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©" class="bg-gray-800">â˜ªï¸ Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©</option>
                                <option value="Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª" class="bg-gray-800">ğŸŒ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª</option>
                                <option value="Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¨Ø¯Ù†ÙŠØ©" class="bg-gray-800">âš½ Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¨Ø¯Ù†ÙŠØ©</option>
                                <option value="Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„ÙÙ†ÙŠØ©" class="bg-gray-800">ğŸ¨ Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„ÙÙ†ÙŠØ©</option>
                                <option value="Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚ÙŠØ©" class="bg-gray-800">ğŸµ Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚ÙŠØ©</option>
                                <option value="Ø§Ù„Ø­Ø§Ø³ÙˆØ¨" class="bg-gray-800">ğŸ’» Ø§Ù„Ø­Ø§Ø³ÙˆØ¨</option>
                                <option value="Ø±ÙŠØ§Ø¶ Ø§Ù„Ø£Ø·ÙØ§Ù„" class="bg-gray-800">ğŸ§¸ Ø±ÙŠØ§Ø¶ Ø§Ù„Ø£Ø·ÙØ§Ù„</option>
                                <option value="Ù…Ø¹Ù„Ù…Ø© ÙØµÙ„" class="bg-gray-800">ğŸ‘©â€ğŸ« Ù…Ø¹Ù„Ù…Ø© ÙØµÙ„</option>
                                <option value="Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ø·Ø§Ø¨ÙˆØ±" class="bg-gray-800">ğŸ« Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ø·Ø§Ø¨ÙˆØ±</option>
                                <option value="Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©" class="bg-gray-800">ğŸ“» Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©</option>
                                <option value="Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù…ÙŠ" class="bg-gray-800">ğŸ“º Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù…ÙŠ</option>
                                <option value="Ø£Ø®Ø±Ù‰" class="bg-gray-800">ğŸ“ Ø£Ø®Ø±Ù‰</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white font-bold mb-3 text-lg">Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙÙŠ Ø§Ù„Ø·Ø§Ø¨ÙˆØ±</label>
                            <input type="text" id="teacherPosition" required class="w-full px-6 py-4 glass-morphism rounded-2xl text-white placeholder-white placeholder-opacity-70 focus:ring-2 focus:ring-white focus:ring-opacity-50 transition-all duration-300 text-lg" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³ Ø£ØŒ Ø§Ù„Ø·Ø§Ø¨ÙˆØ±ØŒ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©...">
                        </div>
                    </div>
                    <div class="flex gap-4 mt-8">
                        <button type="submit" class="flex-1 btn-gradient text-white font-bold py-4 px-8 rounded-2xl transition-all duration-300 flex items-center justify-center gap-3 text-lg hover:scale-105 shadow-lg">
                            <span class="text-xl">âœ…</span>
                            Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¹Ù„Ù…Ø©
                        </button>
                        <button type="button" onclick="hideAddTeacherForm()" class="flex-1 glass-morphism text-white font-bold py-4 px-8 rounded-2xl transition-all duration-300 hover:scale-105 flex items-center justify-center gap-3 text-lg shadow-lg">
                            <span class="text-xl">âŒ</span>
                            Ø¥Ù„ØºØ§Ø¡
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Certificate Modal -->
        <div id="certificateModal" class="fixed inset-0 modal-backdrop hidden flex items-center justify-center z-50">
            <div class="star-shower">
                <div class="falling-star" style="left: 10%; animation-delay: 0s;">â­</div>
                <div class="falling-star" style="left: 20%; animation-delay: 0.5s;">ğŸŒŸ</div>
                <div class="falling-star" style="left: 30%; animation-delay: 1s;">â­</div>
                <div class="falling-star" style="left: 40%; animation-delay: 1.5s;">ğŸŒŸ</div>
                <div class="falling-star" style="left: 50%; animation-delay: 2s;">â­</div>
                <div class="falling-star" style="left: 60%; animation-delay: 2.5s;">ğŸŒŸ</div>
                <div class="falling-star" style="left: 70%; animation-delay: 3s;">â­</div>
                <div class="falling-star" style="left: 80%; animation-delay: 3.5s;">ğŸŒŸ</div>
                <div class="falling-star" style="left: 90%; animation-delay: 4s;">â­</div>
            </div>
            <div class="certificate-modal rounded-3xl p-12 max-w-2xl w-full mx-4 shadow-2xl text-center">
                <div class="text-8xl mb-6 star-animation">ğŸ†</div>
                <h2 class="text-4xl font-bold text-white mb-4 font-['Amiri']">Ø´Ù‡Ø§Ø¯Ø© ØªÙ‚Ø¯ÙŠØ±</h2>
                <div class="text-6xl mb-6">ğŸŒŸ</div>
                <h3 class="text-2xl font-bold text-yellow-300 mb-6">Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ</h3>
                <div class="bg-white bg-opacity-20 rounded-2xl p-6 mb-6">
                    <p class="text-xl text-white mb-4">ØªÙÙ…Ù†Ø­ Ù‡Ø°Ù‡ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø¥Ù„Ù‰</p>
                    <h4 id="certificateName" class="text-3xl font-bold text-yellow-300 mb-4">Ø§Ø³Ù… Ø§Ù„ÙØ§Ø¦Ø²</h4>
                    <p class="text-lg text-white mb-2">Ù„ØªÙÙˆÙ‚Ù‡Ù… ÙÙŠ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ</p>
                    <div class="flex justify-center gap-4 mt-4">
                        <div class="criteria-badge">âš¡ Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù…</div>
                        <div class="criteria-badge">ğŸ”Š Ø§Ù„ØµÙˆØª Ø§Ù„Ø¹Ø§Ù„ÙŠ</div>
                        <div class="criteria-badge">âœ¨ Ø§Ù„Ù†Ø¸Ø§ÙØ© Ø§Ù„Ø´Ø®ØµÙŠØ©</div>
                    </div>
                </div>
                <div class="text-lg text-white mb-6">
                    <p id="certificateDate">Ø§Ù„ØªØ§Ø±ÙŠØ®: </p>
                    <p id="certificateScore">Ø§Ù„Ù†ØªÙŠØ¬Ø©: </p>
                </div>
                <div class="flex gap-4 justify-center">
                    <button onclick="downloadCertificate()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 flex items-center gap-2">
                        <span>ğŸ“„</span>
                        ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©
                    </button>
                    <button onclick="closeCertificate()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300">
                        Ø¥ØºÙ„Ø§Ù‚
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Message -->
    <div id="successMessage" class="fixed top-6 left-6 glass-morphism text-white px-8 py-6 rounded-3xl shadow-2xl hidden success-message z-50">
        <div class="flex items-center gap-4">
            <div class="relative">
                <span class="text-3xl floating-icon">âœ…</span>
                <div class="sparkle" style="top: 0; right: 0; animation-delay: 0s;"></div>
                <div class="sparkle" style="bottom: 0; left: 0; animation-delay: 0.5s;"></div>
            </div>
            <span id="successText" class="text-lg font-bold">ØªÙ… Ø¨Ù†Ø¬Ø§Ø­!</span>
        </div>
    </div>

    <!-- Import Data Input -->
    <input type="file" id="importFile" accept=".json" class="hidden" onchange="handleImportData(event)">

    <script>
        let teachers = JSON.parse(localStorage.getItem('femaleTeachers')) || [];
        let attendance = JSON.parse(localStorage.getItem('femaleAttendance')) || {};
        let attendanceTimes = JSON.parse(localStorage.getItem('femaleAttendanceTimes')) || {};
        let verifications = JSON.parse(localStorage.getItem('femaleVerifications')) || {};
        let classes = JSON.parse(localStorage.getItem('schoolClasses')) || {
            grade5: [],
            grade6: []
        };
        let monthlyWinners = JSON.parse(localStorage.getItem('monthlyWinners')) || {};
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateDateTime();
            setInterval(updateDateTime, 1000);
            renderTeachers();
            updateStats();
            initializeYearSelector();
            setCurrentMonth();
            renderClasses();
            renderMonthlyWinners();
        });

        function updateDateTime() {
            const now = new Date();
            const dateOptions = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            const timeOptions = { 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit' 
            };
            
            document.getElementById('currentDate').textContent = now.toLocaleDateString('ar-SA', dateOptions);
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('ar-SA', timeOptions);
        }

        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab-button').forEach(tab => {
                tab.classList.remove('active');
                tab.classList.add('glass-morphism', 'text-white');
            });
            
            // Show selected tab content
            document.getElementById(tabName + 'Content').classList.remove('hidden');
            
            // Add active class to selected tab
            const activeTab = document.getElementById(tabName + 'Tab');
            activeTab.classList.add('active');
            activeTab.classList.remove('glass-morphism', 'text-white');
            
            // Update reports if reports tab is selected
            if (tabName === 'reports') {
                updateMonthlyReport();
            }
        }

        function renderTeachers() {
            const container = document.getElementById('teachersGrid');

            if (teachers.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full text-center text-gray-400 py-12">
                        <div class="text-6xl mb-4">ğŸ‘©â€ğŸ«</div>
                        <p class="text-xl font-semibold">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ù„Ù…Ø§Øª Ù…Ø³Ø¬Ù„Ø§Øª Ø¨Ø¹Ø¯</p>
                        <p class="text-sm mt-2">Ø§Ù†ØªÙ‚Ù„ÙŠ Ø¥Ù„Ù‰ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</p>
                    </div>
                `;
                return;
            }

            const today = new Date().toDateString();
            
            container.innerHTML = teachers.map(teacher => {
                const isPresent = attendance[today] && attendance[today][teacher.id];
                const attendanceTime = attendanceTimes[today] && attendanceTimes[today][teacher.id];
                const isVerified = verifications[today] && verifications[today][teacher.id];
                const subjectEmoji = getSubjectEmoji(teacher.subject);
                const positionEmoji = getPositionEmoji(teacher.position);
                
                // Check for daily star (before 7:30 AM)
                const hasDailyStar = attendanceTime && isPresent && new Date(attendanceTime).getHours() < 7 || 
                                   (new Date(attendanceTime).getHours() === 7 && new Date(attendanceTime).getMinutes() <= 30);
                
                // Check for monthly star (90% attendance)
                const monthlyAttendanceRate = getTeacherMonthlyRate(teacher.id);
                const hasMonthlystar = monthlyAttendanceRate >= 90;
                
                const cardStyle = isPresent === true ? 'present-card' : 
                                 isPresent === false ? 'absent-card' : '';
                
                return `
                    <div class="teacher-card rounded-3xl p-8 shadow-2xl fade-in ${cardStyle}" >
                        <div class="text-center">
                            <div class="relative w-20 h-20 mx-auto mb-6">
                                <div class="absolute inset-0 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full opacity-20 pulse-ring"></div>
                                <div class="relative w-20 h-20 glass-morphism rounded-full flex items-center justify-center floating-icon">
                                    <span class="text-4xl">ğŸ‘©â€ğŸ«</span>
                                    ${hasDailyStar ? '<div class="absolute -top-2 -right-2 star-animation"><span class="text-2xl">â­</span></div>' : ''}
                                    ${hasMonthlystar ? '<div class="absolute -top-2 -left-2 star-animation"><span class="text-2xl">ğŸŒŸ</span></div>' : ''}
                                    ${isVerified ? '<div class="absolute -bottom-2 -right-2 verification-badge"><span class="text-2xl">âœ…</span></div>' : ''}
                                </div>
                            </div>
                            <h3 class="text-2xl font-bold mb-4 ${isPresent === true || isPresent === false ? 'text-white' : 'text-white'}">${teacher.name}</h3>
                            <div class="space-y-3 text-sm mb-6">
                                <div class="flex items-center justify-center gap-3 glass-morphism rounded-2xl py-3 px-4">
                                    <span class="text-xl">${subjectEmoji}</span>
                                    <span class="font-bold text-white">${teacher.subject}</span>
                                </div>
                                <div class="flex items-center justify-center gap-3 glass-morphism rounded-2xl py-3 px-4">
                                    <span class="text-xl">${positionEmoji}</span>
                                    <span class="font-bold text-white text-sm">${teacher.position}</span>
                                </div>
                                ${attendanceTime ? `
                                    <div class="text-sm text-white glass-morphism rounded-2xl py-2 px-4 flex items-center justify-center gap-2">
                                        <span class="text-lg floating-icon">â°</span>
                                        <span class="font-semibold">${new Date(attendanceTime).toLocaleTimeString('ar-SA', {hour: '2-digit', minute: '2-digit'})}</span>
                                    </div>
                                ` : ''}
                            </div>
                            <div class="flex gap-3 mb-4">
                                <button 
                                    onclick="markPresent('${teacher.id}')"
                                    class="flex-1 py-4 px-6 rounded-2xl font-bold transition-all duration-300 transform hover:scale-105 ${
                                        isPresent === true
                                        ? 'bg-gradient-to-r from-green-400 to-blue-500 text-white shadow-2xl' 
                                        : 'glass-morphism text-white hover:bg-white hover:bg-opacity-30'
                                    }"
                                >
                                    <div class="flex items-center justify-center gap-3">
                                        <span class="text-2xl floating-icon">${isPresent === true ? 'âœ…' : 'â­•'}</span>
                                        <span class="text-lg">Ø­Ø§Ø¶Ø±Ø©</span>
                                    </div>
                                </button>
                                <button 
                                    onclick="markAbsent('${teacher.id}')"
                                    class="flex-1 py-4 px-6 rounded-2xl font-bold transition-all duration-300 transform hover:scale-105 ${
                                        isPresent === false 
                                        ? 'bg-gradient-to-r from-red-400 to-pink-500 text-white shadow-2xl' 
                                        : 'glass-morphism text-white hover:bg-white hover:bg-opacity-30'
                                    }"
                                >
                                    <div class="flex items-center justify-center gap-3">
                                        <span class="text-2xl floating-icon">${isPresent === false ? 'âŒ' : 'â­•'}</span>
                                        <span class="text-lg">ØºØ§Ø¦Ø¨Ø©</span>
                                    </div>
                                </button>
                            </div>
                            ${isPresent === true ? `
                                <button 
                                    onclick="verifyAttendance('${teacher.id}')"
                                    class="w-full py-3 px-6 rounded-2xl font-bold transition-all duration-300 transform hover:scale-105 ${
                                        isVerified 
                                        ? 'bg-gradient-to-r from-blue-400 to-indigo-500 text-white shadow-2xl' 
                                        : 'glass-morphism text-white hover:bg-white hover:bg-opacity-30'
                                    }"
                                >
                                    <div class="flex items-center justify-center gap-3">
                                        <span class="text-xl floating-icon">${isVerified ? 'âœ…' : 'ğŸ“¸'}</span>
                                        <span class="text-lg">${isVerified ? 'ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚' : 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¶ÙˆØ±'}</span>
                                    </div>
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderClasses() {
            renderGrade5Classes();
            renderGrade6Classes();
        }

        function renderGrade5Classes() {
            const container = document.getElementById('grade5Classes');
            if (classes.grade5.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙˆÙ Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯</p>';
                return;
            }

            container.innerHTML = classes.grade5.map(classData => `
                <div class="class-card rounded-2xl p-4">
                    <div class="flex justify-between items-center mb-3">
                        <h4 class="text-lg font-bold text-white">${classData.name}</h4>
                        <div class="text-2xl font-bold text-yellow-400">${classData.totalScore}/70</div>
                    </div>
                    <div class="grid grid-cols-3 gap-2 mb-3">
                        <div class="text-center">
                            <div class="text-sm text-gray-300">Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù…</div>
                            <div class="text-lg font-bold text-blue-400">${classData.speed}/20</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm text-gray-300">Ø§Ù„ØµÙˆØª Ø§Ù„Ø¹Ø§Ù„ÙŠ</div>
                            <div class="text-lg font-bold text-green-400">${classData.voice}/25</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm text-gray-300">Ø§Ù„Ù†Ø¸Ø§ÙØ©</div>
                            <div class="text-lg font-bold text-pink-400">${classData.cleanliness}/25</div>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="editClassScores('grade5', '${classData.id}')" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-xl text-sm transition duration-200">
                            ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø·
                        </button>
                        <button onclick="removeClass('grade5', '${classData.id}')" class="bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-xl text-sm transition duration-200">
                            Ø­Ø°Ù
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function renderGrade6Classes() {
            const container = document.getElementById('grade6Classes');
            if (classes.grade6.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙˆÙ Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯</p>';
                return;
            }

            container.innerHTML = classes.grade6.map(classData => `
                <div class="class-card rounded-2xl p-4">
                    <div class="flex justify-between items-center mb-3">
                        <h4 class="text-lg font-bold text-white">${classData.name}</h4>
                        <div class="text-2xl font-bold text-yellow-400">${classData.totalScore}/70</div>
                    </div>
                    <div class="grid grid-cols-3 gap-2 mb-3">
                        <div class="text-center">
                            <div class="text-sm text-gray-300">Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù…</div>
                            <div class="text-lg font-bold text-blue-400">${classData.speed}/20</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm text-gray-300">Ø§Ù„ØµÙˆØª Ø§Ù„Ø¹Ø§Ù„ÙŠ</div>
                            <div class="text-lg font-bold text-green-400">${classData.voice}/25</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm text-gray-300">Ø§Ù„Ù†Ø¸Ø§ÙØ©</div>
                            <div class="text-lg font-bold text-pink-400">${classData.cleanliness}/25</div>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="editClassScores('grade6', '${classData.id}')" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-xl text-sm transition duration-200">
                            ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø·
                        </button>
                        <button onclick="removeClass('grade6', '${classData.id}')" class="bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-xl text-sm transition duration-200">
                            Ø­Ø°Ù
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function addGrade5Class() {
            const className = prompt('Ø£Ø¯Ø®Ù„ÙŠ Ø§Ø³Ù… Ø§Ù„ØµÙ (Ù…Ø«Ø§Ù„: Ø§Ù„Ø®Ø§Ù…Ø³ Ø£):');
            if (className) {
                const newClass = {
                    id: Date.now().toString(),
                    name: className,
                    speed: 0,
                    voice: 0,
                    cleanliness: 0,
                    totalScore: 0
                };
                classes.grade5.push(newClass);
                localStorage.setItem('schoolClasses', JSON.stringify(classes));
                renderGrade5Classes();
                showSuccess(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${className} Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰`);
            }
        }

        function addGrade6Class() {
            const className = prompt('Ø£Ø¯Ø®Ù„ÙŠ Ø§Ø³Ù… Ø§Ù„ØµÙ (Ù…Ø«Ø§Ù„: Ø§Ù„Ø³Ø§Ø¯Ø³ Ø¨):');
            if (className) {
                const newClass = {
                    id: Date.now().toString(),
                    name: className,
                    speed: 0,
                    voice: 0,
                    cleanliness: 0,
                    totalScore: 0
                };
                classes.grade6.push(newClass);
                localStorage.setItem('schoolClasses', JSON.stringify(classes));
                renderGrade6Classes();
                showSuccess(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${className} Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰`);
            }
        }

        function editClassScores(grade, classId) {
            const classData = classes[grade].find(c => c.id === classId);
            if (!classData) return;

            const speed = parseInt(prompt(`Ù†Ù‚Ø§Ø· Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù… Ù„Ù„ØµÙ ${classData.name} (0-20):`, classData.speed) || 0);
            const voice = parseInt(prompt(`Ù†Ù‚Ø§Ø· Ø§Ù„ØµÙˆØª Ø§Ù„Ø¹Ø§Ù„ÙŠ Ù„Ù„ØµÙ ${classData.name} (0-25):`, classData.voice) || 0);
            const cleanliness = parseInt(prompt(`Ù†Ù‚Ø§Ø· Ø§Ù„Ù†Ø¸Ø§ÙØ© Ø§Ù„Ø´Ø®ØµÙŠØ© Ù„Ù„ØµÙ ${classData.name} (0-25):`, classData.cleanliness) || 0);

            if (speed >= 0 && speed <= 20 && voice >= 0 && voice <= 25 && cleanliness >= 0 && cleanliness <= 25) {
                classData.speed = speed;
                classData.voice = voice;
                classData.cleanliness = cleanliness;
                classData.totalScore = speed + voice + cleanliness;
                
                localStorage.setItem('schoolClasses', JSON.stringify(classes));
                renderClasses();
                showSuccess(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ù†Ù‚Ø§Ø· ${classData.name} Ø¨Ù†Ø¬Ø§Ø­! ğŸ“Š`);
            } else {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Ù‚Ø§Ø· ØµØ­ÙŠØ­Ø© Ø¶Ù…Ù† Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ø­Ø¯Ø¯');
            }
        }

        function removeClass(grade, classId) {
            const classData = classes[grade].find(c => c.id === classId);
            if (classData && confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† Ø­Ø°Ù ${classData.name}ØŸ`)) {
                classes[grade] = classes[grade].filter(c => c.id !== classId);
                localStorage.setItem('schoolClasses', JSON.stringify(classes));
                renderClasses();
                showSuccess(`ØªÙ… Ø­Ø°Ù ${classData.name} ğŸ—‘ï¸`);
            }
        }

        function selectGrade5Winner() {
            if (classes.grade5.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙˆÙ ÙÙŠ Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³');
                return;
            }

            const winner = classes.grade5.reduce((prev, current) => 
                (prev.totalScore > current.totalScore) ? prev : current
            );

            const currentMonth = new Date().toISOString().slice(0, 7); // YYYY-MM format
            if (!monthlyWinners[currentMonth]) {
                monthlyWinners[currentMonth] = {};
            }
            monthlyWinners[currentMonth].grade5 = winner;
            
            localStorage.setItem('monthlyWinners', JSON.stringify(monthlyWinners));
            renderMonthlyWinners();
            showCertificate(winner.name, winner.totalScore, 'Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³');
            showSuccess(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${winner.name} ÙƒØ¨Ø·Ù„ Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³! ğŸ†`);
        }

        function selectGrade6Winner() {
            if (classes.grade6.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙˆÙ ÙÙŠ Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³');
                return;
            }

            const winner = classes.grade6.reduce((prev, current) => 
                (prev.totalScore > current.totalScore) ? prev : current
            );

            const currentMonth = new Date().toISOString().slice(0, 7); // YYYY-MM format
            if (!monthlyWinners[currentMonth]) {
                monthlyWinners[currentMonth] = {};
            }
            monthlyWinners[currentMonth].grade6 = winner;
            
            localStorage.setItem('monthlyWinners', JSON.stringify(monthlyWinners));
            renderMonthlyWinners();
            showCertificate(winner.name, winner.totalScore, 'Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³');
            showSuccess(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${winner.name} ÙƒØ¨Ø·Ù„ Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³! ğŸ†`);
        }

        function renderMonthlyWinners() {
            const currentMonth = new Date().toISOString().slice(0, 7);
            const winners = monthlyWinners[currentMonth] || {};

            const grade5Container = document.getElementById('grade5Winner');
            const grade6Container = document.getElementById('grade6Winner');

            if (winners.grade5) {
                grade5Container.innerHTML = `
                    <div class="text-center">
                        <div class="text-4xl mb-2 star-animation">ğŸ†</div>
                        <h5 class="text-xl font-bold text-yellow-400 mb-2">${winners.grade5.name}</h5>
                        <p class="text-white">Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${winners.grade5.totalScore}/70</p>
                        <button onclick="showCertificate('${winners.grade5.name}', ${winners.grade5.totalScore}, 'Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³')" class="mt-2 bg-blue-500 hover:bg-blue-600 text-white py-1 px-4 rounded-lg text-sm">
                            Ø¹Ø±Ø¶ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©
                        </button>
                    </div>
                `;
            } else {
                grade5Container.innerHTML = '<p class="text-gray-300">Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø·Ù„ Ø¨Ø¹Ø¯</p>';
            }

            if (winners.grade6) {
                grade6Container.innerHTML = `
                    <div class="text-center">
                        <div class="text-4xl mb-2 star-animation">ğŸ†</div>
                        <h5 class="text-xl font-bold text-yellow-400 mb-2">${winners.grade6.name}</h5>
                        <p class="text-white">Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${winners.grade6.totalScore}/70</p>
                        <button onclick="showCertificate('${winners.grade6.name}', ${winners.grade6.totalScore}, 'Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³')" class="mt-2 bg-blue-500 hover:bg-blue-600 text-white py-1 px-4 rounded-lg text-sm">
                            Ø¹Ø±Ø¶ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©
                        </button>
                    </div>
                `;
            } else {
                grade6Container.innerHTML = '<p class="text-gray-300">Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø·Ù„ Ø¨Ø¹Ø¯</p>';
            }
        }

        function showCertificate(name, score, grade) {
            document.getElementById('certificateName').textContent = name;
            document.getElementById('certificateDate').textContent = `Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleDateString('ar-SA')}`;
            document.getElementById('certificateScore').textContent = `Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${score}/70 Ù†Ù‚Ø·Ø©`;
            document.getElementById('certificateModal').classList.remove('hidden');
        }

        function closeCertificate() {
            document.getElementById('certificateModal').classList.add('hidden');
        }

        function downloadCertificate() {
            // Create a simple text-based certificate for download
            const name = document.getElementById('certificateName').textContent;
            const date = document.getElementById('certificateDate').textContent;
            const score = document.getElementById('certificateScore').textContent;
            
            const certificateText = `
ğŸ† Ø´Ù‡Ø§Ø¯Ø© ØªÙ‚Ø¯ÙŠØ± - Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ ğŸ†

${name}

${date}
${score}

Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:
âš¡ Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù…
ğŸ”Š Ø§Ù„ØµÙˆØª Ø§Ù„Ø¹Ø§Ù„ÙŠ  
âœ¨ Ø§Ù„Ù†Ø¸Ø§ÙØ© Ø§Ù„Ø´Ø®ØµÙŠØ©

ØªØµÙ…ÙŠÙ… ÙˆØ¥Ø´Ø±Ø§Ù: Ø£. Ø£Ø­Ù„Ø§Ù… Ø§Ù„Ø­Ù…Ø¯Ø§Ù†ÙŠØ©
Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©
            `;
            
            const blob = new Blob([certificateText], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Ø´Ù‡Ø§Ø¯Ø©_${name.replace(/\s+/g, '_')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSuccess('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­! ğŸ“„');
        }

        function getSubjectEmoji(subject) {
            const emojiMap = {
                'Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª': 'ğŸ”¢',
                'Ø§Ù„Ø¹Ù„ÙˆÙ…': 'ğŸ”¬',
                'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©': 'ğŸ“–',
                'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©': 'ğŸ‡¬ğŸ‡§',
                'Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©': 'â˜ªï¸',
                'Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª': 'ğŸŒ',
                'Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¨Ø¯Ù†ÙŠØ©': 'âš½',
                'Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„ÙÙ†ÙŠØ©': 'ğŸ¨',
                'Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚ÙŠØ©': 'ğŸµ',
                'Ø§Ù„Ø­Ø§Ø³ÙˆØ¨': 'ğŸ’»',
                'Ø±ÙŠØ§Ø¶ Ø§Ù„Ø£Ø·ÙØ§Ù„': 'ğŸ§¸',
                'Ù…Ø¹Ù„Ù…Ø© ÙØµÙ„': 'ğŸ‘©â€ğŸ«',
                'Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ø·Ø§Ø¨ÙˆØ±': 'ğŸ«',
                'Ø§Ù„Ø¥Ø°Ø§Ø¹Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©': 'ğŸ“»',
                'Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù…ÙŠ': 'ğŸ“º'
            };
            return emojiMap[subject] || 'ğŸ“';
        }

        function getPositionEmoji(position) {
            if (position.includes('Ø§Ù„Ø®Ø§Ù…Ø³') || position.includes('Ø§Ù„Ø³Ø§Ø¯Ø³')) return 'ğŸ“š';
            if (position.includes('Ø·Ø§Ø¨ÙˆØ±')) return 'ğŸ«';
            if (position.includes('Ø¥Ø°Ø§Ø¹Ø©')) return 'ğŸ“»';
            if (position.includes('Ø¥Ø¹Ù„Ø§Ù…')) return 'ğŸ“º';
            return 'ğŸ“';
        }

        function markPresent(teacherId) {
            const today = new Date().toDateString();
            if (!attendance[today]) attendance[today] = {};
            if (!attendanceTimes[today]) attendanceTimes[today] = {};
            
            attendance[today][teacherId] = true;
            attendanceTimes[today][teacherId] = new Date().toISOString();
            
            localStorage.setItem('femaleAttendance', JSON.stringify(attendance));
            localStorage.setItem('femaleAttendanceTimes', JSON.stringify(attendanceTimes));
            
            renderTeachers();
            updateStats();
            showSuccess('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­! âœ…');
        }

        function markAbsent(teacherId) {
            const today = new Date().toDateString();
            if (!attendance[today]) attendance[today] = {};
            
            attendance[today][teacherId] = false;
            
            // Remove verification if exists
            if (verifications[today] && verifications[today][teacherId]) {
                delete verifications[today][teacherId];
                localStorage.setItem('femaleVerifications', JSON.stringify(verifications));
            }
            
            localStorage.setItem('femaleAttendance', JSON.stringify(attendance));
            
            renderTeachers();
            updateStats();
            showSuccess('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØºÙŠØ§Ø¨ ğŸ“');
        }

        function verifyAttendance(teacherId) {
            const today = new Date().toDateString();
            if (!verifications[today]) verifications[today] = {};
            
            verifications[today][teacherId] = true;
            localStorage.setItem('femaleVerifications', JSON.stringify(verifications));
            
            renderTeachers();
            showSuccess('ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙØ¹Ù„ÙŠ! âœ…');
        }

        function markAllPresent() {
            if (teachers.length === 0) {
                showSuccess('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ù„Ù…Ø§Øª Ù„ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±Ù‡Ù† âŒ');
                return;
            }

            const today = new Date().toDateString();
            if (!attendance[today]) attendance[today] = {};
            if (!attendanceTimes[today]) attendanceTimes[today] = {};
            
            teachers.forEach(teacher => {
                attendance[today][teacher.id] = true;
                attendanceTimes[today][teacher.id] = new Date().toISOString();
            });
            
            localStorage.setItem('femaleAttendance', JSON.stringify(attendance));
            localStorage.setItem('femaleAttendanceTimes', JSON.stringify(attendanceTimes));
            
            renderTeachers();
            updateStats();
            showSuccess(`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª (${teachers.length}) Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰`);
        }

        function clearAttendance() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† Ù…Ø³Ø­ Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ØŸ')) {
                const today = new Date().toDateString();
                if (attendance[today]) delete attendance[today];
                if (attendanceTimes[today]) delete attendanceTimes[today];
                if (verifications[today]) delete verifications[today];
                
                localStorage.setItem('femaleAttendance', JSON.stringify(attendance));
                localStorage.setItem('femaleAttendanceTimes', JSON.stringify(attendanceTimes));
                localStorage.setItem('femaleVerifications', JSON.stringify(verifications));
                
                renderTeachers();
                updateStats();
                showSuccess('ØªÙ… Ù…Ø³Ø­ Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ… ğŸ”„');
            }
        }

        function updateStats() {
            const today = new Date().toDateString();
            const todayAttendance = attendance[today] || {};
            
            const totalTeachers = teachers.length;
            const presentCount = Object.values(todayAttendance).filter(status => status === true).length;
            const absentCount = Object.values(todayAttendance).filter(status => status === false).length;
            
            // Calculate daily stars (attendance before 7:30 AM)
            const todayTimes = attendanceTimes[today] || {};
            let dailyStars = 0;
            
            Object.entries(todayTimes).forEach(([teacherId, timeStr]) => {
                if (todayAttendance[teacherId] === true) {
                    const time = new Date(timeStr);
                    if (time.getHours() < 7 || (time.getHours() === 7 && time.getMinutes() <= 30)) {
                        dailyStars++;
                    }
                }
            });
            
            const attendanceRate = totalTeachers > 0 ? Math.round((presentCount / totalTeachers) * 100) : 0;
            
            document.getElementById('totalTeachers').textContent = totalTeachers;
            document.getElementById('presentCount').textContent = presentCount;
            document.getElementById('absentCount').textContent = absentCount;
            document.getElementById('dailyStars').textContent = dailyStars;
            document.getElementById('attendanceRate').textContent = attendanceRate + '%';
        }

        function getTeacherMonthlyRate(teacherId) {
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            
            let presentDays = 0;
            let totalDays = 0;
            
            Object.entries(attendance).forEach(([dateStr, dayAttendance]) => {
                const date = new Date(dateStr);
                if (date.getMonth() === currentMonth && date.getFullYear() === currentYear) {
                    if (dayAttendance[teacherId] !== undefined) {
                        totalDays++;
                        if (dayAttendance[teacherId] === true) {
                            presentDays++;
                        }
                    }
                }
            });
            
            return totalDays > 0 ? Math.round((presentDays / totalDays) * 100) : 0;
        }

        function showAddTeacherForm() {
            document.getElementById('addTeacherModal').classList.remove('hidden');
        }

        function hideAddTeacherForm() {
            document.getElementById('addTeacherModal').classList.add('hidden');
            document.getElementById('addTeacherForm').reset();
        }

        function addTeacher(event) {
            event.preventDefault();
            
            const name = document.getElementById('teacherName').value.trim();
            const subject = document.getElementById('teacherSubject').value;
            const position = document.getElementById('teacherPosition').value.trim();
            
            if (!name || !subject || !position) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }
            
            const newTeacher = {
                id: Date.now().toString(),
                name: name,
                subject: subject,
                position: position
            };
            
            teachers.push(newTeacher);
            localStorage.setItem('femaleTeachers', JSON.stringify(teachers));
            
            hideAddTeacherForm();
            renderTeachers();
            updateStats();
            showSuccess(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¹Ù„Ù…Ø© ${name} Ø¨Ù†Ø¬Ø§Ø­! ğŸ‘©â€ğŸ«`);
        }

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const fileStatus = document.getElementById('fileStatus');
            fileStatus.classList.remove('hidden');

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

                    processExcelData(jsonData);
                    fileStatus.classList.add('hidden');
                    showSuccess('ØªÙ… Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø¨Ù†Ø¬Ø§Ø­! ğŸ“Š');
                } catch (error) {
                    console.error('Error processing file:', error);
                    fileStatus.classList.add('hidden');
                    showSuccess('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù âŒ');
                }
            };

            reader.onerror = function() {
                fileStatus.classList.add('hidden');
                showSuccess('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù âŒ');
            };

            reader.readAsArrayBuffer(file);
        }

        function processExcelData(data) {
            const newTeachers = [];
            
            // Skip header row and process data
            for (let i = 1; i < data.length; i++) {
                const row = data[i];
                if (row && row.length >= 2) {
                    const grade = row[0] ? row[0].toString().trim() : '';
                    
                    // Process teacher names from remaining columns
                    for (let j = 1; j < row.length; j++) {
                        const teacherName = row[j] ? row[j].toString().trim() : '';
                        if (teacherName && teacherName !== '') {
                            const teacher = {
                                id: Date.now().toString() + '_' + i + '_' + j,
                                name: teacherName,
                                subject: 'Ù…Ø¹Ù„Ù…Ø© ÙØµÙ„', // Default subject
                                position: grade || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
                            };
                            newTeachers.push(teacher);
                        }
                    }
                }
            }
            
            if (newTeachers.length > 0) {
                teachers.push(...newTeachers);
                localStorage.setItem('femaleTeachers', JSON.stringify(teachers));
                renderTeachers();
                updateStats();
                showSuccess(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${newTeachers.length} Ù…Ø¹Ù„Ù…Ø© Ù…Ù† Ø§Ù„Ù…Ù„Ù! ğŸ‰`);
            } else {
                showSuccess('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹Ù„Ù…Ø§Øª ÙÙŠ Ø§Ù„Ù…Ù„Ù âŒ');
            }
        }

        function initializeYearSelector() {
            const yearSelector = document.getElementById('yearSelector');
            const currentYear = new Date().getFullYear();
            
            for (let year = currentYear - 2; year <= currentYear + 1; year++) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                if (year === currentYear) option.selected = true;
                yearSelector.appendChild(option);
            }
        }

        function setCurrentMonth() {
            const monthSelector = document.getElementById('monthSelector');
            monthSelector.value = new Date().getMonth();
        }

        function updateMonthlyReport() {
            const month = parseInt(document.getElementById('monthSelector').value);
            const year = parseInt(document.getElementById('yearSelector').value);
            
            // Calculate monthly statistics
            let workingDays = 0;
            let totalAttendance = 0;
            let totalPossibleAttendance = 0;
            let monthlyStars = 0;
            let bestDayAttendance = 0;
            let bestDay = '-';
            
            const monthlyData = {};
            
            Object.entries(attendance).forEach(([dateStr, dayAttendance]) => {
                const date = new Date(dateStr);
                if (date.getMonth() === month && date.getFullYear() === year) {
                    workingDays++;
                    
                    const dayPresent = Object.values(dayAttendance).filter(status => status === true).length;
                    const dayTotal = Object.keys(dayAttendance).length;
                    
                    totalAttendance += dayPresent;
                    totalPossibleAttendance += dayTotal;
                    
                    // Check for daily stars
                    const dayTimes = attendanceTimes[dateStr] || {};
                    Object.entries(dayTimes).forEach(([teacherId, timeStr]) => {
                        if (dayAttendance[teacherId] === true) {
                            const time = new Date(timeStr);
                            if (time.getHours() < 7 || (time.getHours() === 7 && time.getMinutes() <= 30)) {
                                monthlyStars++;
                            }
                        }
                    });
                    
                    // Track best day
                    const dayRate = dayTotal > 0 ? (dayPresent / dayTotal) * 100 : 0;
                    if (dayRate > bestDayAttendance) {
                        bestDayAttendance = dayRate;
                        bestDay = date.toLocaleDateString('ar-SA', { weekday: 'long', day: 'numeric' });
                    }
                }
            });
            
            const avgAttendance = totalPossibleAttendance > 0 ? Math.round((totalAttendance / totalPossibleAttendance) * 100) : 0;
            
            document.getElementById('workingDays').textContent = workingDays;
            document.getElementById('avgAttendance').textContent = avgAttendance + '%';
            document.getElementById('monthlyStars').textContent = monthlyStars;
            document.getElementById('bestDay').textContent = bestDay;
            
            // Generate teacher reports
            generateTeacherReports(month, year);
        }

        function generateTeacherReports(month, year) {
            const container = document.getElementById('teacherReports');
            
            if (teachers.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-center py-8">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ù„Ù…Ø§Øª Ù…Ø³Ø¬Ù„Ø§Øª</p>';
                return;
            }
            
            const teacherStats = teachers.map(teacher => {
                let presentDays = 0;
                let totalDays = 0;
                let stars = 0;
                
                Object.entries(attendance).forEach(([dateStr, dayAttendance]) => {
                    const date = new Date(dateStr);
                    if (date.getMonth() === month && date.getFullYear() === year) {
                        if (dayAttendance[teacher.id] !== undefined) {
                            totalDays++;
                            if (dayAttendance[teacher.id] === true) {
                                presentDays++;
                                
                                // Check for star
                                const dayTimes = attendanceTimes[dateStr] || {};
                                if (dayTimes[teacher.id]) {
                                    const time = new Date(dayTimes[teacher.id]);
                                    if (time.getHours() < 7 || (time.getHours() === 7 && time.getMinutes() <= 30)) {
                                        stars++;
                                    }
                                }
                            }
                        }
                    }
                });
                
                const rate = totalDays > 0 ? Math.round((presentDays / totalDays) * 100) : 0;
                
                return {
                    ...teacher,
                    presentDays,
                    totalDays,
                    rate,
                    stars
                };
            });
            
            // Sort by attendance rate
            teacherStats.sort((a, b) => b.rate - a.rate);
            
            container.innerHTML = teacherStats.map((teacher, index) => `
                <div class="glass-morphism rounded-xl p-4 flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold">
                            ${index + 1}
                        </div>
                        <div>
                            <h4 class="text-lg font-bold text-white">${teacher.name}</h4>
                            <p class="text-gray-300 text-sm">${teacher.subject} - ${teacher.position}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-2xl font-bold ${teacher.rate >= 90 ? 'text-green-400' : teacher.rate >= 75 ? 'text-yellow-400' : 'text-red-400'}">${teacher.rate}%</div>
                        <div class="text-sm text-gray-300">${teacher.presentDays}/${teacher.totalDays} ÙŠÙˆÙ…</div>
                        ${teacher.stars > 0 ? `<div class="text-yellow-400 text-sm">â­ ${teacher.stars} Ù†Ø¬Ù…Ø©</div>` : ''}
                    </div>
                </div>
            `).join('');
        }

        function exportMonthlyReport() {
            const month = parseInt(document.getElementById('monthSelector').value);
            const year = parseInt(document.getElementById('yearSelector').value);
            
            const monthNames = ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ', 
                              'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'];
            
            let reportContent = `ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ - ${monthNames[month]} ${year}\n`;
            reportContent += `ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±: ${new Date().toLocaleDateString('ar-SA')}\n\n`;
            
            // Add teacher statistics
            teachers.forEach(teacher => {
                let presentDays = 0;
                let totalDays = 0;
                let stars = 0;
                
                Object.entries(attendance).forEach(([dateStr, dayAttendance]) => {
                    const date = new Date(dateStr);
                    if (date.getMonth() === month && date.getFullYear() === year) {
                        if (dayAttendance[teacher.id] !== undefined) {
                            totalDays++;
                            if (dayAttendance[teacher.id] === true) {
                                presentDays++;
                                
                                const dayTimes = attendanceTimes[dateStr] || {};
                                if (dayTimes[teacher.id]) {
                                    const time = new Date(dayTimes[teacher.id]);
                                    if (time.getHours() < 7 || (time.getHours() === 7 && time.getMinutes() <= 30)) {
                                        stars++;
                                    }
                                }
                            }
                        }
                    }
                });
                
                const rate = totalDays > 0 ? Math.round((presentDays / totalDays) * 100) : 0;
                
                reportContent += `${teacher.name} - ${teacher.subject}\n`;
                reportContent += `Ø§Ù„Ø­Ø¶ÙˆØ±: ${presentDays}/${totalDays} ÙŠÙˆÙ… (${rate}%)\n`;
                if (stars > 0) reportContent += `Ø§Ù„Ù†Ø¬ÙˆÙ…: ${stars}\n`;
                reportContent += `Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${teacher.position}\n\n`;
            });
            
            const blob = new Blob([reportContent], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ØªÙ‚Ø±ÙŠØ±_${monthNames[month]}_${year}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSuccess('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ! ğŸ“„');
        }

        function exportTeacherAttendance() {
            if (teachers.length === 0) {
                showSuccess('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹Ù„Ù…Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ± âŒ');
                return;
            }
            
            const wb = XLSX.utils.book_new();
            
            // Create attendance data
            const attendanceData = [['Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…Ø©', 'Ø§Ù„Ù…Ø§Ø¯Ø©', 'Ø§Ù„Ù…ÙˆÙ‚Ø¹', 'Ø§Ù„ØªØ§Ø±ÙŠØ®', 'Ø§Ù„Ø­Ø¶ÙˆØ±', 'ÙˆÙ‚Øª Ø§Ù„ÙˆØµÙˆÙ„', 'ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚']];
            
            Object.entries(attendance).forEach(([dateStr, dayAttendance]) => {
                const date = new Date(dateStr);
                const formattedDate = date.toLocaleDateString('ar-SA');
                
                teachers.forEach(teacher => {
                    if (dayAttendance[teacher.id] !== undefined) {
                        const isPresent = dayAttendance[teacher.id];
                        const arrivalTime = attendanceTimes[dateStr] && attendanceTimes[dateStr][teacher.id] 
                            ? new Date(attendanceTimes[dateStr][teacher.id]).toLocaleTimeString('ar-SA', {hour: '2-digit', minute: '2-digit'})
                            : '';
                        const isVerified = verifications[dateStr] && verifications[dateStr][teacher.id] ? 'Ù†Ø¹Ù…' : 'Ù„Ø§';
                        
                        attendanceData.push([
                            teacher.name,
                            teacher.subject,
                            teacher.position,
                            formattedDate,
                            isPresent ? 'Ø­Ø§Ø¶Ø±Ø©' : 'ØºØ§Ø¦Ø¨Ø©',
                            arrivalTime,
                            isVerified
                        ]);
                    }
                });
            });
            
            const ws = XLSX.utils.aoa_to_sheet(attendanceData);
            XLSX.utils.book_append_sheet(wb, ws, 'Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª');
            
            XLSX.writeFile(wb, `Ø­Ø¶ÙˆØ±_Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª_${new Date().toISOString().slice(0, 10)}.xlsx`);
            showSuccess('ØªÙ… ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±! ğŸ“Š');
        }

        function exportAllData() {
            const allData = {
                teachers: teachers,
                attendance: attendance,
                attendanceTimes: attendanceTimes,
                verifications: verifications,
                classes: classes,
                monthlyWinners: monthlyWinners,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(allData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Ù†Ø³Ø®Ø©_Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©_${new Date().toISOString().slice(0, 10)}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSuccess('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©! ğŸ’¾');
        }

        function importData() {
            document.getElementById('importFile').click();
        }

        function handleImportData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (data.teachers) teachers = data.teachers;
                    if (data.attendance) attendance = data.attendance;
                    if (data.attendanceTimes) attendanceTimes = data.attendanceTimes;
                    if (data.verifications) verifications = data.verifications;
                    if (data.classes) classes = data.classes;
                    if (data.monthlyWinners) monthlyWinners = data.monthlyWinners;
                    
                    // Save to localStorage
                    localStorage.setItem('femaleTeachers', JSON.stringify(teachers));
                    localStorage.setItem('femaleAttendance', JSON.stringify(attendance));
                    localStorage.setItem('femaleAttendanceTimes', JSON.stringify(attendanceTimes));
                    localStorage.setItem('femaleVerifications', JSON.stringify(verifications));
                    localStorage.setItem('schoolClasses', JSON.stringify(classes));
                    localStorage.setItem('monthlyWinners', JSON.stringify(monthlyWinners));
                    
                    // Refresh displays
                    renderTeachers();
                    updateStats();
                    renderClasses();
                    renderMonthlyWinners();
                    
                    showSuccess('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­! ğŸ“¥');
                } catch (error) {
                    showSuccess('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª âŒ');
                    console.error('Import error:', error);
                }
            };
            
            reader.readAsText(file);
            event.target.value = '';
        }

        function clearAllData() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡!')) {
                localStorage.clear();
                
                teachers = [];
                attendance = {};
                attendanceTimes = {};
                verifications = {};
                classes = { grade5: [], grade6: [] };
                monthlyWinners = {};
                
                renderTeachers();
                updateStats();
                renderClasses();
                renderMonthlyWinners();
                
                showSuccess('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ğŸ—‘ï¸');
            }
        }

        function showSuccess(message) {
            const successMessage = document.getElementById('successMessage');
            const successText = document.getElementById('successText');
            
            successText.textContent = message;
            successMessage.classList.remove('hidden');
            
            setTimeout(() => {
                successMessage.classList.add('hidden');
            }, 4000);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97c0e2582392d1e8',t:'MTc1NzM2MDA3NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
